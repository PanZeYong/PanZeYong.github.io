<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="PANJU's Note" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="笔记——记录工作和学习中的点点滴滴">
<meta property="og:type" content="website">
<meta property="og:title" content="PANJU's Note">
<meta property="og:url" content="https://panzeyong.github.io/index.html">
<meta property="og:site_name" content="PANJU's Note">
<meta property="og:description" content="笔记——记录工作和学习中的点点滴滴">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PANJU's Note">
<meta name="twitter:description" content="笔记——记录工作和学习中的点点滴滴">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://panzeyong.github.io/"/>





  <title>PANJU's Note</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">PANJU's Note</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">故不积跬步，无以至千里；不积小流，无以成江海。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://panzeyong.github.io/2017/08/13/第九章-客户端检测/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PANJU">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PANJU's Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/13/第九章-客户端检测/" itemprop="url">第九章 客户端检测</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-13T17:23:34+08:00">
                2017-08-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/13/第九章-客户端检测/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/13/第九章-客户端检测/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/08/13/第九章-客户端检测/" class="leancloud_visitors" data-flag-title="第九章 客户端检测">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、能力检测"><a href="#一、能力检测" class="headerlink" title="一、能力检测"></a>一、能力检测</h1><p>能力检测的目标不是识别特定的浏览器，而是识别浏览器的能力。比如说，函数 <strong>document.getElementById</strong> 在不同浏览器是否被支持。</p>
<p>能力检测有两个重要概念：一是先检测达成目的的最常用的特性；二是必须测试实际要用到的特性。</p>
<p>示例如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElement</span>(<span class="params">id</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.getElementById) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.all) &#123;&#125;&#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.all[id];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="二、怪癖检测"><a href="#二、怪癖检测" class="headerlink" title="二、怪癖检测"></a>二、怪癖检测</h1><p>识别浏览器的特殊行为，即检测浏览器存在什么缺陷。怪癖检测无法精确地检测特定的浏览器和版本。</p>
<h1 id="三、用户代理检测"><a href="#三、用户代理检测" class="headerlink" title="三、用户代理检测"></a>三、用户代理检测</h1><p>通过检测用户代理字符串来确定实际使用的浏览器，可以通过 JavaScript 的 <strong>navigator.userAgent</strong> 属性访问。</p>
<h3 id="1、主要浏览器所使用的呈现引擎如下表："><a href="#1、主要浏览器所使用的呈现引擎如下表：" class="headerlink" title="1、主要浏览器所使用的呈现引擎如下表："></a>1、主要浏览器所使用的呈现引擎如下表：</h3><table><tr align="center"><th>浏览器</th><td>IE</td><td>Opera</td><td>Chrome</td><td>Firefox</td><td>Safari</td><td>Konqueror</td></tr><tr align="center"><th>呈现引擎</th><td>IE</td><td>Opera</td><td>WebKit</td><td>Gecko</td><td>WebKit</td><td>KHTML</td></tr></table>

<h3 id="2、用户代理字符串（userAgent）所包含属性如下表："><a href="#2、用户代理字符串（userAgent）所包含属性如下表：" class="headerlink" title="2、用户代理字符串（userAgent）所包含属性如下表："></a>2、用户代理字符串（userAgent）所包含属性如下表：</h3><table><tr align="center"><th width="25%">字符串项</th><th width="15%">必须吗</th><th width="60%">说明</th></tr><tr align="center"><td>Mozilla 版本号</td><td>是</td><td>Mozilla 的版本号</td></tr><tr align="center"><td>平台</td><td>是</td><td>浏览器运行的平台。可能的值包括 Windows、Mac 和 X11（指 Unix 的 X 窗口系统）</td></tr><tr align="center"><td>加密类型</td><td>是</td><td>加密技术的类型：U 表示 128 位、I 表示 40 位、N 表示未加密</td></tr><tr align="center"><td>操作系统或 CPU</td><td>是</td><td>浏览器运行的操作系统或计算机系统使用的 CPU。在 Windows 平台中，这一项指 Windows 的版本（如 WinNT、Win95，等等）。如果平台是 Macintosh，这一项是 Unix 操作系统的名称，与使用 Unix 命令 uname-sm 得到的名称相同。</td></tr><tr align="center"><td>语言</td><td>是</td><td>浏览器设计时所针对的目标用户语言</td></tr><tr align="center"><td>预先发行版本</td><td>否</td><td>最初用于表示 Mozilla 的预先发行版本，现在则用来表示 Gecko 呈现引擎的版本号</td></tr><tr align="center"><td>Gecko 版本号</td><td>是</td><td>Gecko 呈现引擎的版本号，但由 yyyymmdd 格式的日期表示</td></tr><tr align="center"><td>应用程序或产品</td><td>否</td><td>使用 Gecko 的产品名。可能是 Netscape、Firefox 等</td></tr><tr align="center"><td>应用程序或产品版本号</td><td>否</td><td>应用程序或产品的版本号；用于区分 Mozilla 版本号或 Gecko 版本号</td></tr><br></table>

<h3 id="3、用户代理字符串检测技术"><a href="#3、用户代理字符串检测技术" class="headerlink" title="3、用户代理字符串检测技术"></a>3、用户代理字符串检测技术</h3><p>通过编写脚本检测浏览器呈现引擎、浏览器、平台、Windows 操作系统、移动设备、游戏系统以此来满足项目中需求。</p>
<p>声明全局变量 client，并使用模块增强模式来封装脚本，示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> client = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> engine = &#123;</div><div class="line">        <span class="comment">// 呈现引擎</span></div><div class="line">        ie: <span class="number">0</span>,</div><div class="line">        gecko: <span class="number">0</span>,</div><div class="line">        webkit: <span class="number">0</span>,</div><div class="line">        khtml: <span class="number">0</span>,</div><div class="line">        opera: <span class="number">0</span>,</div><div class="line"></div><div class="line">        <span class="comment">// 具体的版本号</span></div><div class="line">        ver: <span class="literal">null</span></div><div class="line">    &#125;;</div><div class="line">	</div><div class="line">    <span class="keyword">var</span> browser = &#123;</div><div class="line">        <span class="comment">// 浏览器</span></div><div class="line">        ie: <span class="number">0</span>,</div><div class="line">        firefox: <span class="number">0</span>,</div><div class="line">        safari: <span class="number">0</span>,</div><div class="line">        konq: <span class="number">0</span>,</div><div class="line">        opera: <span class="number">0</span>,</div><div class="line">        chrome: <span class="number">0</span>,</div><div class="line"></div><div class="line">        <span class="comment">// 具体的版本</span></div><div class="line">        ver: <span class="literal">null</span></div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> system = &#123;</div><div class="line">        <span class="comment">// 检测平台</span></div><div class="line">        win: <span class="literal">false</span>,</div><div class="line">        mac: <span class="literal">false</span>,</div><div class="line">        x11: <span class="literal">false</span>,</div><div class="line"></div><div class="line">        <span class="comment">// 移动设备</span></div><div class="line">        iphone: <span class="literal">false</span>,</div><div class="line">        ipod: <span class="literal">false</span>,</div><div class="line">        ipad: <span class="literal">false</span>,</div><div class="line">        ios: <span class="literal">false</span>,</div><div class="line">        android: <span class="literal">false</span>,</div><div class="line">        nokiaN: <span class="literal">false</span>,</div><div class="line">        winMobile: <span class="literal">false</span>,</div><div class="line"></div><div class="line">        <span class="comment">// 游戏系统</span></div><div class="line">        wii: <span class="literal">false</span>,</div><div class="line">        ps: <span class="literal">false</span></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="comment">// 在此检测呈现引擎、平台和设备（各部分代码以下给出）</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        engine: engine,</div><div class="line">        browser: browser,</div><div class="line">        system: system</div><div class="line">    &#125;;</div><div class="line">&#125;();</div><div class="line"></div><div class="line"><span class="keyword">var</span> userAgent = navigator.userAgent;</div></pre></td></tr></table></figure>
<h4 id="（1）、识别呈现引擎以及浏览器"><a href="#（1）、识别呈现引擎以及浏览器" class="headerlink" title="（1）、识别呈现引擎以及浏览器"></a>（1）、识别呈现引擎以及浏览器</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * 识别呈现浏览器步骤如下：</div><div class="line"> * </div><div class="line"> * 1. 第一步：检测 Opera</div><div class="line"> * 2. 第二步：检测 WebKit</div><div class="line"> * 3. 第三步：检测 KHTML</div><div class="line"> * 4. 第四步：检测 Gecko</div><div class="line"> * 5. 第五步：检测 IE</div><div class="line">*/</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.opera) &#123;</div><div class="line">    alert(<span class="string">"Opera"</span>);</div><div class="line">    engine.ver = browser.ver = <span class="built_in">window</span>.opera.version();</div><div class="line">    engine.opera = browser.opera = <span class="built_in">parseFloat</span>(engine.ver);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/AppleWebKit\/(\S+)/</span>.test(userAgent)) &#123;</div><div class="line">    alert(<span class="string">"AppleWebKit"</span>);</div><div class="line">    engine.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">    engine.webkit = <span class="built_in">parseFloat</span>(engine.ver);</div><div class="line"></div><div class="line">    <span class="comment">// 确定是 Chrome 还是 Safari</span></div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/Chrome\/(\S+)/</span>.test(userAgent)) &#123;</div><div class="line">        browser.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">        browser.chrome = <span class="built_in">parseFloat</span>(browser.ver);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/Version\/(\S+)/</span>.test(userAgent)) &#123;</div><div class="line">        browser.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">        browser.safari = <span class="built_in">parseFloat</span>(browser.ver);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 近似地确定版本号</span></div><div class="line">        <span class="keyword">var</span> safariVersion = <span class="number">1</span>;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (engine.webkit &lt; <span class="number">100</span>) &#123;</div><div class="line">            safariVersion = <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (engine.webkit &lt; <span class="number">312</span>) &#123;</div><div class="line">            safariVersion = <span class="number">1.2</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (engine.webkit &lt; <span class="number">412</span>) &#123;</div><div class="line">            safariVersion = <span class="number">1.3</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            safariVersion = <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        browser.safari = browser.ver = safariVersion;</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/KHTML\/(\S+)/</span>.test(userAgent) || <span class="regexp">/Konqueror\/([^;]+)/</span>.test(userAgent)) &#123;</div><div class="line">    alert(<span class="string">"KHTML"</span>);</div><div class="line"></div><div class="line">    engine.ver = browser.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">    engine.khtml = browser.konq = <span class="built_in">parseFloat</span>(engine.ver);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/rv:([^\)]+)\) Gecko\/\d&#123;8&#125;/</span>.test(userAgent)) &#123;</div><div class="line">    alert(<span class="string">"Gecko"</span>);</div><div class="line"></div><div class="line">    engine.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">    engine.gecko = <span class="built_in">parseFloat</span>(engine.ver);</div><div class="line"></div><div class="line">    <span class="comment">// 确定是不是 Firefox</span></div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/Firefox\/(\S+)/</span>.test(userAgent)) &#123;</div><div class="line">        browser.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">        browser.firefox = <span class="built_in">parseFloat</span>(browser.ver);</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/MSIE ([^;]+)/</span>.test(userAgent)) &#123;</div><div class="line">    alert(<span class="string">"IE"</span>);</div><div class="line"></div><div class="line">    engine.ver = browser.ver = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">    engine.ie = browser.ie = <span class="built_in">parseFloat</span>(engine.ver);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有了以上代码，就可以对浏览器进行检测，示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (client.engine.webkit) &#123;</div><div class="line">    <span class="keyword">if</span> (client.browser.chrome) &#123;</div><div class="line">        alert(<span class="string">"Chrome : "</span> + client.browser.chrome);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.browser.safari) &#123;</div><div class="line">        alert(<span class="string">"Safari : "</span> + client.browser.safari);</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.engine.gecko) &#123;</div><div class="line">    <span class="keyword">if</span> (client.browser.firefox) &#123;</div><div class="line">        alert(<span class="string">"Firefox : "</span> + client.browser.firefox);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        alert(<span class="string">"Not Firefox Browser"</span>);</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.engine.opera) &#123;</div><div class="line">    <span class="keyword">if</span> (client.browser.opera) &#123;</div><div class="line">        alert(<span class="string">"Opera : "</span> + client.browser.opera);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        alert(<span class="string">"Not Opera Browser"</span>);</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.engine.khtml) &#123;</div><div class="line">    <span class="keyword">if</span> (client.browser.konq) &#123;</div><div class="line">        alert(<span class="string">"konq : "</span> + client.browser.konq);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        alert(<span class="string">"Not konq Browser"</span>);</div><div class="line">    &#125;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.engine.ie) &#123;</div><div class="line">    <span class="keyword">if</span> (client.browser.ie) &#123;</div><div class="line">        alert(<span class="string">"IE : "</span> + client.browser.ie);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        alert(<span class="string">"Not IE Browser"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="（2）、识别平台"><a href="#（2）、识别平台" class="headerlink" title="（2）、识别平台"></a>（2）、识别平台</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> platform = navigator.platform;</div><div class="line"></div><div class="line">system.win = platform.indexOf(<span class="string">"Win"</span>) == <span class="number">0</span>;</div><div class="line">system.mac = platform.indexOf(<span class="string">"Mac"</span>) == <span class="number">0</span>;</div><div class="line">system.x11 = (platform.indexOf(<span class="string">"x11"</span>) == <span class="number">0</span>) || (platform.indexOf(<span class="string">"Linux"</span>) == <span class="number">0</span>);</div><div class="line"></div><div class="line">alert(<span class="string">"Win : "</span> + system.win);</div><div class="line">alert(<span class="string">"Mac : "</span> + system.mac);</div><div class="line">alert(<span class="string">"X11 : "</span> + system.x11);</div></pre></td></tr></table></figure>
<h4 id="（3）、识别-Windows-操作系统"><a href="#（3）、识别-Windows-操作系统" class="headerlink" title="（3）、识别 Windows 操作系统"></a>（3）、识别 Windows 操作系统</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (system.win) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/Win(?:dows )?([^do]&#123;2&#125;)\s?(\d+\.\d+)?/</span>.test(userAgent)) &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">RegExp</span>[<span class="string">"$1"</span>] == <span class="string">"NT"</span>) &#123;</div><div class="line">            <span class="keyword">switch</span>(<span class="built_in">RegExp</span>[$<span class="number">2</span>]) &#123;</div><div class="line">                <span class="keyword">case</span> <span class="string">"5.0"</span>:</div><div class="line">                    system.win = <span class="string">"2000"</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                <span class="keyword">case</span> <span class="string">"5.1"</span>:</div><div class="line">                    system.win = <span class="string">"XP"</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                <span class="keyword">case</span> <span class="string">"6.0"</span>:</div><div class="line">                    system.win = <span class="string">"Vista"</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                <span class="keyword">case</span> <span class="string">"6.1"</span>:</div><div class="line">                    system.win = <span class="string">"7"</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line"></div><div class="line">                <span class="keyword">default</span>:</div><div class="line">                    system.win = <span class="string">"NT"</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">RegExp</span>[<span class="string">"$1"</span>] == <span class="string">"9x"</span>) &#123;</div><div class="line">             system.win = <span class="string">"ME"</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">             system.win = <span class="built_in">RegExp</span>[<span class="string">"$1"</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>根据以上代码检测 Windows 操作系统</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (client.system.win == <span class="string">"2000"</span>) &#123;</div><div class="line">    alert(<span class="string">"Windows 2000"</span>);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.system.win == <span class="string">"XP"</span>) &#123;</div><div class="line">    alert(<span class="string">"Windows XP"</span>);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.system.win == <span class="string">"Vista"</span>) &#123;</div><div class="line">    alert(<span class="string">"Windows Vista"</span>);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.system.win == <span class="string">"7"</span>) &#123;</div><div class="line">    alert(<span class="string">"Windows 7"</span>);</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.system.win == <span class="string">"NT"</span>) &#123;</div><div class="line">    alert(<span class="string">"Windows NT"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="4-、识别移动设备"><a href="#4-、识别移动设备" class="headerlink" title="(4)、识别移动设备"></a>(4)、识别移动设备</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">system.iphone = userAgent.indexOf(<span class="string">"iPhone"</span>) &gt; <span class="number">-1</span>;</div><div class="line">system.ipod = userAgent.indexOf(<span class="string">"iPod"</span>) &gt; <span class="number">-1</span>;</div><div class="line">system.ipad = userAgent.indexOf(<span class="string">"iPad"</span>) &gt; <span class="number">-1</span>;</div><div class="line"></div><div class="line"><span class="comment">// 检测 iOS 版本</span></div><div class="line"><span class="keyword">if</span> (system.mac &amp;&amp; userAgent.indexOf(<span class="string">"Mobile"</span>) &gt; <span class="number">-1</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/CPU (?:iPhone )?OS (\d+_\d+)/</span>.test(userAgent)) &#123;</div><div class="line">        system.ios = <span class="built_in">parseFloat</span>(<span class="built_in">RegExp</span>.$<span class="number">1.</span>replace(<span class="string">"_"</span>, <span class="string">"."</span>));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 无法检测出来</span></div><div class="line">        system.ios = <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 检测 Android 版本</span></div><div class="line"><span class="keyword">if</span> (<span class="regexp">/Android (\d+\.\d+)/</span>.test(userAgent)) &#123;</div><div class="line">    system.android = <span class="built_in">parseFloat</span>(<span class="built_in">RegExp</span>.$<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 检测 诺基亚 N 系列</span></div><div class="line">system.nokiaN = userAgent.indexOf(<span class="string">"NokiaN"</span>) &gt; <span class="number">-1</span>;</div><div class="line"></div><div class="line"><span class="comment">// 检测 Windows Mobile</span></div><div class="line"><span class="keyword">if</span> (system.win == <span class="string">"CE"</span>) &#123;</div><div class="line">    system.winMobile = system.win;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (system.win == <span class="string">"Ph"</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/Windows Phone OS (\d+.\d+)/</span>.test(userAgent)) &#123;</div><div class="line">        system.win = <span class="string">"Phone"</span>;</div><div class="line">        system.winMobile = <span class="built_in">parseFloat</span>(<span class="built_in">RegExp</span>[<span class="string">"$1"</span>]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>检测手机，示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (client.engine.webkit) &#123;</div><div class="line">    <span class="keyword">if</span> (client.system.ios) &#123;</div><div class="line">        alert(<span class="string">"iOS 手机"</span>);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.system.android) &#123;</div><div class="line">        alert(<span class="string">"Android 手机"</span>);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (client.system.nokiaN) &#123;</div><div class="line">        alert(<span class="string">"诺基亚 N 系列手机"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="（5）、识别游戏系统"><a href="#（5）、识别游戏系统" class="headerlink" title="（5）、识别游戏系统"></a>（5）、识别游戏系统</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">system.wii = userAgent.indexOf(<span class="string">"Wii"</span>) &gt; <span class="number">-1</span>;</div><div class="line">system.ps = <span class="regexp">/playstation/i</span>.test(userAgent);</div></pre></td></tr></table></figure>
<p>以上是在学习 《JavaScript 高级程序设计》（第 3 版）这本书第九章的学习笔记，主要把书中讲到的要点记录下来，方便自己查找。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://panzeyong.github.io/2017/08/11/Kotlin-开发环境搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PANJU">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PANJU's Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/11/Kotlin-开发环境搭建/" itemprop="url">Kotlin 开发环境搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-11T22:57:49+08:00">
                2017-08-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/11/Kotlin-开发环境搭建/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/11/Kotlin-开发环境搭建/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/08/11/Kotlin-开发环境搭建/" class="leancloud_visitors" data-flag-title="Kotlin 开发环境搭建">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、Kotlin-语言介绍"><a href="#一、Kotlin-语言介绍" class="headerlink" title="一、Kotlin 语言介绍"></a>一、Kotlin 语言介绍</h1><p>Kotlin 是一种基于 JVM 新编程语言，由 JetBrains 开发。Kotlin 不仅可以可以编译成 Java 字节码，而且也可以编译成 JavaScript，方便在没有 JVM 的设备上运行。（来源：百度百科）</p>
<p>在应用上，Kotlin 可以用来开发服务器、Android 以及 JavaScript。</p>
<p>在 2017 年 Google I/O 大会上，官方宣布 Kotlin 正式成为 Android 开发语言。</p>
<p>学习一门新语言，首先要做的第一件事就是搭建开发环境。所谓工欲善其事，必先利其器。</p>
<h1 id="二、Kotlin-开发环境搭建"><a href="#二、Kotlin-开发环境搭建" class="headerlink" title="二、Kotlin 开发环境搭建"></a>二、Kotlin 开发环境搭建</h1><h2 id="（一）、用命令行编译器创建-Hello-World-程序"><a href="#（一）、用命令行编译器创建-Hello-World-程序" class="headerlink" title="（一）、用命令行编译器创建 Hello World 程序"></a>（一）、用命令行编译器创建 Hello World 程序</h2><h3 id="1、下载编译器"><a href="#1、下载编译器" class="headerlink" title="1、下载编译器"></a>1、下载编译器</h3><p>kotlin 编译器最新版本是 1.1.3-2，可以从 <a href="https://github.com/JetBrains/kotlin/releases/tag/v1.1.3-2" target="_blank" rel="external">GitHub Releases</a> 下载。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://panzeyong.github.io/2017/07/25/第八章-BOM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PANJU">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PANJU's Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/25/第八章-BOM/" itemprop="url">第八章 BOM</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-25T07:42:23+08:00">
                2017-07-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavsScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavsScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/25/第八章-BOM/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/25/第八章-BOM/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/07/25/第八章-BOM/" class="leancloud_visitors" data-flag-title="第八章 BOM">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、window-对象"><a href="#一、window-对象" class="headerlink" title="一、window 对象"></a>一、window 对象</h2><h3 id="1、全局作用域"><a href="#1、全局作用域" class="headerlink" title="1、全局作用域"></a>1、全局作用域</h3><p>window 对象具有双重角色</p>
<ul>
<li><p>通过 JavaScript 访问浏览器窗口的一个接口；</p>
</li>
<li><p>ECMAScript 规定的 Global 对象。</p>
</li>
</ul>
<p>定义全局变量与在 window 对象上直接定义属性区别：全局变量不能通过 delete 操作符删除，而直接在 window 对象上定义的属性可以。</p>
<p>尝试访问未声明的变量会抛出错误，但是通过查询 window 对象，可以知道某个可能未声明的变量是否存在。</p>
<p>书中例子如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义全局变量</span></div><div class="line"><span class="keyword">var</span> age = <span class="number">29</span>;</div><div class="line"></div><div class="line"><span class="comment">// 在 window 对象上定义属性</span></div><div class="line"><span class="built_in">window</span>.color = <span class="string">"Green"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 在 IE &lt; 9 时抛出错误，在其他所以浏览器中都返回 false</span></div><div class="line">alert(<span class="keyword">delete</span> <span class="built_in">window</span>.age);</div><div class="line"></div><div class="line"><span class="comment">// 在 IE &lt; 9 时抛出错误，在其他所以浏览器中都返回 true</span></div><div class="line">alert(<span class="keyword">delete</span> <span class="built_in">window</span>.color);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayAge</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="keyword">this</span>.age);</div><div class="line">&#125;</div><div class="line"></div><div class="line">alert(age);</div><div class="line">alert(<span class="built_in">window</span>.age);</div><div class="line"></div><div class="line">sayAge();</div><div class="line"><span class="built_in">window</span>.sayAge();</div><div class="line"></div><div class="line">alert(<span class="built_in">window</span>.color);</div></pre></td></tr></table></figure>
<h3 id="2、窗口关系以及框架"><a href="#2、窗口关系以及框架" class="headerlink" title="2、窗口关系以及框架"></a>2、窗口关系以及框架</h3><p>每个框架（frame）都拥有自己的 window 对象，并且保存在 frames 集合钟；每个 window 对象都有一个 name 属性，包含框架名称。</p>
<p>top 对象：始终指向最高（最外）层的框架，也就是浏览器窗口；使用它可以确保在一个框架中正确第访问另外一个框架。（当网页有框架的情况下，window 对象指向的是每个框架特定的实例，与 top 对象不相等；反之，则相同。）</p>
<p>parent 对象：始终指向当前框架的直接上层框架。（当网页有框架的情况下，parent 不一定等于 top；反之，则一定相等。）</p>
<p>self 对象：始终指向 window，可以与 window 对象互换使用。引入该对象的目的只是为了与 top 和 parent 对象对应起来。</p>
<p>top、parent、self 等对象其实都是 window 的属性，也就是说，可以通过 window.top、window.parent 等访问。</p>
<p>访问框架的方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不推荐，因为在有框架的网页中，每个 window 对象都是指向框架的特定实例，而非指向最外层框架。</span></div><div class="line"><span class="built_in">window</span>.frames[index]</div><div class="line"><span class="built_in">window</span>.frames[<span class="string">"框架名称"</span>]</div><div class="line"></div><div class="line"><span class="comment">// 推荐，因为始终指向最高（最外）层的框架，也就是浏览器窗口</span></div><div class="line">top.frames[index]</div><div class="line">top.frames[<span class="string">"框架名称"</span>]</div><div class="line"></div><div class="line"><span class="comment">// 通过集合访问</span></div><div class="line">frames[index]</div><div class="line">frames[<span class="string">"框架名称"</span>]</div></pre></td></tr></table></figure>
<h3 id="3、窗口位置"><a href="#3、窗口位置" class="headerlink" title="3、窗口位置"></a>3、窗口位置</h3><p>screenLeft、screenTop、screenX、screenY 这四个属性在各个浏览器中使用情况：</p>
<table><tr align="center"><td width="25%" align="center">浏览器 / 属性</td><td width="15%" align="center">IE</td><td width="15%" align="center">Chrome</td><td width="15%" align="center">Sarari</td><td width="15%" align="center">Opera</td><td width="15%" align="center">Firefox</td></tr><tr align="center"><td>screenLeft</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>不支持</td></tr><tr align="center"><td>screenTop</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>不支持</td></tr><tr align="center"><td>screenX</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>screenY</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr></table>

<p>跨浏览器获取窗口左边和上边的位置的示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> leftPos = (<span class="keyword">typeof</span> <span class="built_in">window</span>.screenLeft == <span class="string">"number"</span>) ? <span class="built_in">window</span>.screenLeft : <span class="built_in">window</span>.screenX;</div><div class="line"><span class="keyword">var</span> topPos = (<span class="keyword">typeof</span> <span class="built_in">window</span>.screenTop == <span class="string">"number"</span> )? <span class="built_in">window</span>.screenTop : <span class="built_in">window</span>.screenY;</div></pre></td></tr></table></figure>
<h3 id="4、窗口大小"><a href="#4、窗口大小" class="headerlink" title="4、窗口大小"></a>4、窗口大小</h3><p>innerWidth、innerHeight、outerWidth、outerHegiht 这四个属性在以下浏览器是支持的，不同的是获取的值，具体情况如下：</p>
<table><tr align="center"><td width="25%">浏览器 / 属性</td><td width="15%">IE9+</td><td width="15%">Chrome</td><td width="15%">Sarari</td><td width="15%">Opera</td><td width="15%">Firefox</td></tr><tr align="center"><td>innerWidth</td><td>页面视图区的大小（减去边框宽度）</td><td>视口（viewport）大小而非浏览器窗口的大小</td><td>页面视图区的大小（减去边框宽度）</td><td>页面视图区的大小（减去边框宽度）</td><td>页面视图区的大小（减去边框宽度）支持</td></tr><tr align="center"><td>innerHeight</td><td>页面视图区的大小（减去边框宽度）</td><td>视口（viewport）大小而非浏览器窗口的大小</td><td>页面视图区的大小（减去边框宽度）</td><td>页面视图区的大小（减去边框宽度）</td><td>不页面视图区的大小（减去边框宽度）</td></tr><tr align="center"><td>outerWidth</td><td>返回浏览器本身窗口的大小</td><td>视口（viewport）大小而非浏览器窗口的大小</td><td>返回浏览器本身窗口的大小</td><td>页面视图容器大小（单个标签页对应的浏览器窗口）</td><td>返回浏览器本身窗口的大小</td></tr><tr align="center"><td>outerHeight</td><td>返回浏览器本身窗口的大小</td><td>视口（viewport）大小而非浏览器窗口的大小</td><td>返回浏览器本身窗口的大小</td><td>页面视图容器大小（单个标签页对应的浏览器窗口）</td><td>返回浏览器本身窗口的大小</td></tr></table>

<p>document.documentElement.clientWidth、document.documentElement.clientHeight、document.body.clientWidth、document.body.clientHeight 这四个属性作用主要是保存页面视口信息，在不同浏览器使用情况如下：</p>
<table><tr align="center"><td width="50%">浏览器 / 属性</td><td width="10%">IE</td><td width="10%">Chrome</td><td width="10%">Sarari</td><td width="10%">Opera</td><td width="10%">Firefox</td></tr><tr align="center"><td>document.documentElement.clientWidth</td><td>支持（IE6 中标准模式）</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>document.documentElement.clientHeight</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>document.body.clientWidth</td><td>支持（混杂模式）</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>document.body.clientHeight</td><td>支持（混杂模式）</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr></table>

<p>获取页面视口大小示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> pageWidth = <span class="built_in">window</span>.innerWidth;</div><div class="line"><span class="keyword">var</span> pageHeight = <span class="built_in">window</span>.innerHeight;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> pageWidth != <span class="string">"number"</span>) &#123;</div><div class="line">	<span class="keyword">if</span> (<span class="built_in">document</span>.compatMode == <span class="string">"CSS1Compat"</span>) &#123;</div><div class="line">		pageWidth = <span class="built_in">document</span>.documentElement.clientWidth;</div><div class="line">		pageHeight = <span class="built_in">document</span>.documentElement.clientHeight;</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		pageWidth = <span class="built_in">document</span>.body.clientWidth;</div><div class="line">		pageHeight = <span class="built_in">document</span>.body.clientHeight;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="5、导航和打开窗口"><a href="#5、导航和打开窗口" class="headerlink" title="5、导航和打开窗口"></a>5、导航和打开窗口</h3><p><strong>window.open()：</strong>既可以导航到特定的 URL，也可以打开一个新的浏览器窗口。接收 4 个参数，具体如下：</p>
<ul>
<li><p>加载的 URL；</p>
</li>
<li><p>窗口目标：_self、_parent、_top、_blank（指定窗口的话就在该窗口打开 URL；没有的话就根据浏览器设置打开新标签页或者打开新的窗口）；</p>
</li>
<li><p>特性字符串：不允许出现空格；</p>
</li>
<li><p>布尔值（表示新页面是否取代浏览器历史记录中当前加载页面）</p>
</li>
</ul>
<p>第三个参数设置窗口特性，具体如下：</p>
<table><tr align="center"><td width="20%">设置</td><td width="20%">值</td><td width="60%">说明</td></tr><tr align="center"><td width="20%">fullscreen</td><td width="20%">yes / no</td><td width="60%">表示浏览器窗口是否最大化。仅限 IE</td></tr><tr align="center"><td width="20%">height</td><td width="20%">数值</td><td width="60%">表示新窗口的高度。不能小于 100</td></tr><tr align="center"><td width="20%">left</td><td width="20%">数值</td><td width="60%">表示新窗口的左坐标。不能是负值</td></tr><tr align="center"><td width="20%">location</td><td width="20%">yes / no</td><td width="60%">表示是否在浏览器窗口中显示地址栏。不同浏览器的默认值不同。如果设置为 no，地址栏可能会隐藏，也可能会被禁止（取决于浏览器）</td></tr><tr align="center"><td width="20%">menubar</td><td width="20%">yes / no</td><td width="60%">表示是否在浏览器窗口中显示菜单栏。默认值为 no</td></tr><tr align="center"><td width="20%">resizeable</td><td width="20%">yes / no</td><td width="60%">表示是否可以通过拖动浏览器窗口的边框改变其大小。默认值为 no</td></tr><tr align="center"><td width="20%">scrollbars</td><td width="20%">yes / no</td><td width="60%">表示如果内容在视口中显示不下，是否允许滚动。默认值为 no</td></tr><tr align="center"><td width="20%">status</td><td width="20%">yes / no</td><td width="60%">表示是否在浏览器窗口中显示状态栏。默认值 no</td></tr><tr align="center"><td width="20%">toolbar</td><td width="20%">yes / no</td><td width="60%">表示是否在浏览器窗口中显示工具栏。默认值为 no</td></tr><tr align="center"><td width="20%">top</td><td width="20%">数值</td><td width="60%">表示新窗口的上坐标。不能是负值</td></tr><tr align="center"><td width="20%">width</td><td width="20%">数值</td><td width="60%">表示新窗口的宽度。不能小于 100</td></tr></table>

<p><strong>opener</strong>：新创建窗口属性，保存着打开它的原始窗口对象。opener 设置为 null，表示在单独的进程中运行新标签页。（Chrome）</p>
<p><strong>屏蔽弹出窗口方式：</strong></p>
<ul>
<li><p>浏览器内置的屏蔽程序阻止的弹出窗口，window.open 很可能返回 null。</p>
</li>
<li><p>浏览器扩展或者其它程序阻止的弹出窗口，window.open() 通常会抛出一个错误。</p>
</li>
</ul>
<p>示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> blocked = <span class="literal">false</span>;</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">	<span class="keyword">var</span> baiduWin = <span class="built_in">window</span>.open(<span class="string">"http://www.baidu.com"</span>, <span class="string">"topFrame"</span>, <span class="string">"height=400,widht=600,left=25,top=25,location=no,menubar=no,resizable=true,scrollbars=yes,status=no,toolbar=no"</span>);</div><div class="line">	</div><div class="line">	<span class="keyword">if</span> (<span class="literal">null</span> == baiduWin) &#123;</div><div class="line">		blocked = <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">&#125; <span class="keyword">catch</span> (ex) &#123;</div><div class="line">	blocked = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (blocked) &#123;</div><div class="line">	alert(<span class="string">"The popup was blocked !"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">	alert(<span class="string">"The popup was not blocked !"</span>);</div><div class="line">	alert(baiduWin);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="6、间歇调用和超时调用"><a href="#6、间歇调用和超时调用" class="headerlink" title="6、间歇调用和超时调用"></a>6、间歇调用和超时调用</h3><p>一般认为，使用超时调用来模拟间歇调用的是一种最佳模式。在开发环境下，很少使用真正的间歇调用，原因是后一个间歇调用可能会在前一个间歇调用结束之前启动。</p>
<p><strong>setTimeout()</strong>：超时调用,返回一个数值 ID，表示唯一标识。接收两个参数：要执行的代码和以毫秒表示的时间（即在执行代码前需要等待多时毫秒）</p>
<p><strong>setInterval()</strong>：间歇调用。接收两个参数：要执行的代码和每次执行之前需要等待的毫秒数。</p>
<p><strong>clearTimeout()</strong>：根据相应的 id 取消调用。</p>
<p>示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="string">"Hello World !"</span>);</div><div class="line">&#125;, <span class="number">1000</span>);</div><div class="line"></div><div class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="string">"Hello World"</span>);</div><div class="line">&#125;, <span class="number">1000</span>);</div></pre></td></tr></table></figure>
<h3 id="7、系统对话框"><a href="#7、系统对话框" class="headerlink" title="7、系统对话框"></a>7、系统对话框</h3><p><strong>alert()：</strong>警告框。</p>
<p><strong>comfirm()：</strong>确认对话框。</p>
<p><strong>prompt()：</strong>提示对话框。</p>
<p><strong>window.print()：</strong>打印。</p>
<p><strong>window.find()：</strong>查找。</p>
<p>示例代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">alert(<span class="string">"Hello World !"</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (confirm(<span class="string">"Are you sure ?"</span>)) &#123;</div><div class="line">	alert(<span class="string">"I'm so glad you're sure !"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">	alert(<span class="string">"I'm sorry to hear you're not sure ."</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> result = prompt(<span class="string">"What is your name ? "</span>, <span class="string">""</span>);</div><div class="line"><span class="keyword">if</span> (<span class="literal">null</span> != result) &#123;</div><div class="line">	alert(<span class="string">"Welcome, "</span> + result);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="二、location-对象"><a href="#二、location-对象" class="headerlink" title="二、location 对象"></a>二、location 对象</h2><p>location 对象不仅提供与当前窗口中加载的文档有关的信息，还提供了一些导航功能以及将 URL 解析为独立的片段。window.location 和 document.location 引用的同是一个对象，即 location 对象。</p>
<p>location 对象所有属性如下表：</p>
<table><tr align="center"><td width="25%">属性名</td><td width="25%">例子</td><td width="50%">说明</td></tr><tr align="center"><td>hash</td><td>“#contents”</td><td>返回 URL 中的 hash（# 号后跟或多个字符），如果 URL 中不包含散列，则返回空字符串</td></tr><tr align="center"><td>host</td><td>“www.wrox.com:80”</td><td>返回服务器名称和端口号（如果有）</td></tr><tr align="center"><td>hostname</td><td>“www.wrox.com”</td><td>返回不带端口号的服务器名称</td></tr><tr align="center"><td>href</td><td>“<a href="http://www.wrox.com" target="_blank" rel="external">http://www.wrox.com</a>“</td><td>返回当前加载页面的完整 URL。而 location 对象的 toString() 方法也返回这个值</td></tr><tralign="center"><td>pathname</td><td>“/WileyCDA”</td><td>返回 URL 中的目录和（或）文件名</td><tr align="center"><td>port</td><td>“8080”</td><td>返回 URL 中指定的端口号。如果 URL 中不包含端口号，则这个属性返回空字符串</td></tr><tr align="center"><td>protocol</td><td>“http”</td><td>返回页面使用的协议。通常是 http: 或 https:</td></tr><tr align="center"><td>search</td><td>“?q=javascript”</td><td>返回 URL 的查询字符串。这个字符串以问号开头</td></tr></tralign="center"></table>

<p>查询参数示例代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getQueryStringArgs</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> qs = (location.search.length &gt; <span class="number">0</span> ? location.search.substring(<span class="number">1</span>) : <span class="string">""</span>);</div><div class="line"></div><div class="line">	args = &#123;&#125;;</div><div class="line"></div><div class="line">	items = qs.length ? qs.split(<span class="string">"&amp;"</span>) : [];</div><div class="line">	item = <span class="literal">null</span>;</div><div class="line">	name = <span class="literal">null</span>;</div><div class="line">	value = <span class="literal">null</span>;</div><div class="line"></div><div class="line">	i = <span class="number">0</span>;</div><div class="line">	len = items.length;</div><div class="line"></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">		item = items[i].split(<span class="string">"="</span>);</div><div class="line">		name = <span class="built_in">decodeURIComponent</span>(item[<span class="number">0</span>]);</div><div class="line">		value = <span class="built_in">decodeURIComponent</span>(item[<span class="number">1</span>]);</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (name.length) &#123;</div><div class="line">			args[name] = value;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> args;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>位置操作方法：</p>
<ul>
<li><p><strong>location.assign(url)</strong>：立即打开新 URL 并在浏览器的历史记录中生成一条记录。<strong>location.href</strong> 与 <strong>window.location</strong> 效果与之一样。</p>
</li>
<li><p><strong>location.replace(url)</strong>：打开新 URL，但是不会下历史记录中生成新记录。</p>
</li>
<li><p><strong>location.reload()</strong>：重新加载当前显示的页面。可接收参数，比如 true，表示从服务器加载。</p>
</li>
</ul>
<h2 id="三、navigator-对象"><a href="#三、navigator-对象" class="headerlink" title="三、navigator 对象"></a>三、navigator 对象</h2><p>navigator 对象属性如下表：</p>
<table><tr align="center"><th width="20%">属性或方法</th><th width="34%">说明</th><th width="8%">IE</th><th width="10%">Firefox</th><th width="18%">Safari/Chrome</th><th width="10%">Opera</th></tr><tr align="center"><td>appCodeName</td><td>浏览器的名称。通常都是 Mozilla，即使在非 Mozilla 浏览器也是如此</td><td>3.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>appMinorVersion</td><td>此版本信息</td><td>4.0+</td><td>-</td><td>-</td><td>9.5+</td></tr><tr align="center"><td>appName</td><td>完整的浏览器名称</td><td>3.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>appVersion</td><td>浏览器的版本。一般不与实际的浏览器版本对应</td><td>3.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>buildId</td><td>浏览器编译版本</td><td>-</td><td>2.0+</td><td>-</td><td>-</td></tr><tr align="center"><td>cookieEnabled</td><td>表示 cookie 是否启用</td><td>4.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>cpuClass</td><td>客户端计算机中使用的 CPU 类型（x86、68K、Alpha、PPC 或 Other）</td><td>4.0+</td><td>-</td><td>-</td><td>-</td></tr><tr align="center"><td>javaEnabled()</td><td>表示当前浏览器中是否启用了 Java</td><td>4.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>language</td><td>浏览器的主语言</td><td>4.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>mimeTypes</td><td>在浏览器中注册的 MIME 类型数组</td><td>4.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>onLine</td><td>表示浏览器是否连接到因特网</td><td>4.0+</td><td>1.0+</td><td>-</td><td>9.5+</td></tr><tr align="center"><td>oscpu</td><td>客户端计算机的操作系统或使用的 CPU</td><td>-</td><td>1.0+</td><td>-</td><td>-</td></tr><tr align="center"><td>platform</td><td>浏览器所在的系统平台</td><td>4.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>plugins</td><td>浏览器中安装的插件信息的数组</td><td>4.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>preference()</td><td>设置用户的首选项</td><td>-</td><td>1.5+</td><td>-</td><td>-</td></tr><tr align="center"><td>product</td><td>产品名称（如 Gecko）</td><td>-</td><td>1.0+</td><td>1.0+</td><td>-</td></tr><tr align="center"><td>productSub</td><td>关于产品的次要信息（如 Gecko 版本）</td><td>-</td><td>1.0+</td><td>1.0+</td><td>-</td></tr><br><tr align="center"><td>systemLanguage</td><td>操作系统的语言</td><td>4.0+</td><td>-</td><td>-</td><td>-</td></tr><tr align="center"><td>userAgent</td><td>浏览器的用户代理字符串</td><td>3.0+</td><td>1.0+</td><td>1.0+</td><td>7.0+</td></tr><tr align="center"><td>userLanguage</td><td>操作系统的默认语言</td><td>4.0+</td><td>-</td><td>-</td><td>7.0+</td></tr><tr align="center"><td>userProfile</td><td>借以访问用户个人信息的对象</td><td>4.0+</td><td>-</td><td>-</td><td>-</td></tr><tr align="center"><td>vendor</td><td>浏览器的品牌</td><td>-</td><td>1.0+</td><td>1.0+</td><td>-</td></tr><tr align="center"><td>vendorSub</td><td>有关供应商的次要信息</td><td>-</td><td>1.0+</td><td>1.0+</td><td>-</td></tr></table>

<h3 id="检测插件"><a href="#检测插件" class="headerlink" title="检测插件"></a>检测插件</h3><p>对于非 IE 浏览器，可以使用 navigator 对象提供的 plugins 属性来检测浏览器插件信息，返回的是数组。该数组中的每一项都包含以下属性：</p>
<ul>
<li><p>name：插件的名字。</p>
</li>
<li><p>description：插件的描述。</p>
</li>
<li><p>filename：插件的文件名。</p>
</li>
<li><p>length：插件所处理的 MIME 类型数量。</p>
</li>
</ul>
<p>检测插件示例代码（在 IE 中无效）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPlugin</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">	name = name.toLowerCase();</div><div class="line"></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; navigator.plugins.length; i++) &#123;</div><div class="line">		<span class="keyword">if</span> (navigator.plugins[i].name.toLowerCase().indexOf(name) &gt; <span class="number">-1</span>) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>检测插件示例代码（只在 IE 中有效）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasIEPlugin</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">		<span class="keyword">new</span> ActiveXObject(name);</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125; <span class="keyword">catch</span> (ex) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="四、screen-对象"><a href="#四、screen-对象" class="headerlink" title="四、screen 对象"></a>四、screen 对象</h2><p>用来表明客户端的能力，其中包括浏览器窗口外部的显示器信息，比如像素宽度和高度。</p>
<p>screen 对象各种属性如下表：</p>
<table><tr><th width="30%">属性</th><th width="30%">说明</th><th width="10%">IE</th><th width="10%">Firefox</th><th width="10%">Safari / Chrome</th><th width="10%">Opera</th></tr><tr align="center"><td>availHeight</td><td>屏幕的像素高度减系统部件高度之后的值（只读）</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>availLeft</td><td>未被系统部件占用的最左侧的像素值（只读）</td><td>不支持</td><td>支持</td><td>支持</td><td>不支持</td></tr><tr align="center"><td>availTop</td><td>未被系统部件占用的最上方的像素值（只读）</td><td>不支持</td><td>支持</td><td>支持</td><td>不支持</td></tr><tr align="center"><td>availWidth</td><td>屏幕的像素宽度减去系统部件宽度之后的值（只读）</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>bufferDepth</td><td>读、写用于呈现屏外位图的位数</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>colorDepth</td><td>用于表现颜色的位数；多数系统是 32（只读）</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>deviceXDPI</td><td>屏幕实际的水平 DPI（只读）</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>deviceYDPI</td><td>屏幕实际的垂直 DPI（只读）</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>fontSmooth / ingEnabled</td><td>表示是否启用字体平滑（只读）</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>height</td><td>屏幕的像素高度</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>left</td><td>当前屏幕距离左边的像素距离</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>logicalXDPI</td><td>屏幕逻辑的水平 DPI（只读）</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>logicalYDPI</td><td>屏幕逻辑的垂直 DPI（只读）</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>pixelDepth</td><td>屏幕的位深</td><td>不支持</td><td>支持</td><td>支持</td><td>支持</td></tr><tr align="center"><td>top</td><td>当前屏幕距上边的像素距离</td><td>不支持</td><td>支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>updateInterval</td><td>读、写以毫秒表示的屏幕刷新时间间隔</td><td>支持</td><td>不支持</td><td>不支持</td><td>不支持</td></tr><tr align="center"><td>width</td><td>屏幕的像素宽度</td><td>支持</td><td>支持</td><td>支持</td><td>支持</td></tr></table>

<h2 id="history-对象"><a href="#history-对象" class="headerlink" title="history 对象"></a>history 对象</h2><p>history 对象保存着用户上网的的历史记录。</p>
<p><strong>go()</strong>：在用户的历史记录中任意跳转，可以向其也可以向后。该方法接收一个参数，正数表示向前，负数表示向后。</p>
<p><strong>back()</strong>：后退。</p>
<p><strong>forward()</strong>：前进。</p>
<p>以上是在学习 《JavaScript 高级程序设计》（第 3 版）这本书第八章的学习笔记，主要把书中讲到的要点记录下来，方便自己查找。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://panzeyong.github.io/2017/07/10/第七章-函数表达式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PANJU">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PANJU's Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/10/第七章-函数表达式/" itemprop="url">第七章 函数表达式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-10T07:11:07+08:00">
                2017-07-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/10/第七章-函数表达式/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/10/第七章-函数表达式/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/07/10/第七章-函数表达式/" class="leancloud_visitors" data-flag-title="第七章 函数表达式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、创建函数方式"><a href="#一、创建函数方式" class="headerlink" title="一、创建函数方式"></a>一、创建函数方式</h2><h3 id="1、函数声明"><a href="#1、函数声明" class="headerlink" title="1、函数声明"></a>1、函数声明</h3><p>声明函数使用的关键字是 function，紧接着是指定函数名及函数体。每个函数都定义一个非标准的 <strong>name</strong> 属性，通过该属性可以访问到给函数指定的名字。对于函数声明来说，有一个重要特征就是<strong>函数提升</strong>，即在执行代码之前会先读取函数声明。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="string">"函数声明"</span>);</div><div class="line">	alert(create.name);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2、函数表达式（匿名函数、拉姆达函数）"><a href="#2、函数表达式（匿名函数、拉姆达函数）" class="headerlink" title="2、函数表达式（匿名函数、拉姆达函数）"></a>2、函数表达式（匿名函数、拉姆达函数）</h3><p>创建一个函数并将其赋值给一个变量，这样的创建的函数也可以称为匿名函数或者拉达姆函数。匿名函数的 name 属性是空字符串。使用这种方式创建函数时，必须<strong>先赋值才可以使用</strong>，否则会报错。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> create = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="string">"函数表达式"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="二、闭包"><a href="#二、闭包" class="headerlink" title="二、闭包"></a>二、闭包</h2><p>闭包是指有权访问另一个函数作用域中的变量的函数。而创建闭包的常用方式，就是在一个函数内部创建另一个函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createComparisonFunction</span>(<span class="params">propertyName</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">"create Comparison Function"</span>);</div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">object1, object2</span>) </span>&#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">"Any"</span>);</div><div class="line">		<span class="keyword">var</span> value1 = object1[propertyName];</div><div class="line">		<span class="keyword">var</span> value2 = object2[propertyName];</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (value1 &lt; value2) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (value1 &gt; value2) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="1、理解作用域链"><a href="#1、理解作用域链" class="headerlink" title="1、理解作用域链"></a>1、理解作用域链</h3><p>当某个函数被调用时，系统会创建一个<strong>执行环境</strong>以及相应的<strong>作用域链</strong>；此时会有一个函数的<strong>活动对象</strong>（变量对象），包含 <strong>arguments</strong> 和其它命名参数。该活动对象会加入到作用域链的前端，并且作用域链的终点是全局执行环境。</p>
<p>在创建函数时，系统会创建一个预先包含全局变量对象的作用域链，这个作用域链被保存在内部的 [[Scope]] 属性中。当调用该函数时，会为函数创建一个执行环境，然后通过复制函数的 [[Scope]] 属性中的对象构建起执行环境的作用域链。</p>
<p>作用域链本质上是一个指向变量对象的指针列表，它只引用但不实际包含变量对象。</p>
<p>函数的执行环境只存在于函数的执行过程中，当执行结束后，活动对象及作用域链被销毁；而全局环境直到程序退出才被销毁。</p>
<p>对于闭包来说情况则不同，由于匿名函数的作用域包含了外部函数，即引用外部函数活动对象；因此，当外部函数执行完毕后，虽然其作用域链被销毁，但是其活动对象仍然留在内存中；直到匿名内部函数被销毁后，此活动对象才会被销毁。</p>
<h3 id="2、闭包与变量"><a href="#2、闭包与变量" class="headerlink" title="2、闭包与变量"></a>2、闭包与变量</h3><p>闭包只能取得包含函数中任意变量的最后一个值。记住闭包保存的是整个变量对象，而不是某个特殊的变量。</p>
<p>先来看一个例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createFunctions</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">"Create Function"</span>);</div><div class="line">	<span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line"></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">"i : "</span> + i);</div><div class="line">		result[i] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			<span class="built_in">console</span>.log(<span class="string">"Result"</span>);</div><div class="line">			<span class="keyword">return</span> i;</div><div class="line">		&#125;;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 返回的是函数数组</span></div><div class="line"><span class="keyword">var</span> result = createFunctions();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; result.length; i++) &#123;</div><div class="line">	alert(result[i]());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>估计很多人跟我一样以为输出的值应该是 0、1、…、9，然而结果却都是 10。说真的，我一开始也懵逼，不知道为什么，但是经过慢慢地调试，稍微了解原因，简单说下自己的理解吧。</p>
<p>当调用函数 <strong>createFunctions()</strong> 时，for 循环就会被执行，这时数组 result 保存着每次执行后的函数，等到执行完之后，i 的值已经变为 10 了；而由于每个函数的作用域链包含外部函数 <strong>createFunctions()</strong> 的活动对象，即共享外部函数变量；因此，调用函数数组中每个函数时的返回值都是 10。</p>
<p>那么如何才能做到每个函数的返回值是其索引呢？见以下例子（ps：书中例子）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createFunctions</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> result = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">"Create Function"</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">		result[i] = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</div><div class="line">			<span class="built_in">console</span>.log(<span class="string">"i : "</span> + i);</div><div class="line">			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">"Number : "</span> + num);</div><div class="line">				<span class="keyword">return</span> num;</div><div class="line">			&#125;</div><div class="line">		&#125;(i);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> result = createFunctions();</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; result.length; i++) &#123;</div><div class="line">	alert(result[i]();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>（ps：由于刚接触闭包这个知识点，对书中的例子还不是很理解，后续补上自己的理解。）</p>
<h3 id="3、关于-this-对象"><a href="#3、关于-this-对象" class="headerlink" title="3、关于 this 对象"></a>3、关于 this 对象</h3><p>this 对象是在运行时基于函数的执行环境绑定的：在全局函数中，this 等于 window，而当函数被作为某个对象的方法调用时，this 等于那个对象。但是匿名函数的执行环境具有全局性，因此其 this 对象通常指向 window。</p>
<p>每个函数被调用时自动取得两个特殊变量：this 和 arguments，那么跟 arguments 跟 this 存在同样的问题。如果想访问作用域中的 arguments 或 this 对象时，必须将该对象的引用保存到另一个闭包能够访问的变量中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"The Window"</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> object = &#123;</div><div class="line">	name : <span class="string">"My Object"</span>,</div><div class="line"></div><div class="line">	getNameFunc : <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> that = <span class="keyword">this</span>;        <span class="comment">// 关键在这行代码</span></div><div class="line">		<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			<span class="keyword">return</span> that.name;</div><div class="line">		&#125;;</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="三、模仿块级作用域"><a href="#三、模仿块级作用域" class="headerlink" title="三、模仿块级作用域"></a>三、模仿块级作用域</h2><p>在函数中定义的局部变量的生命周期只局限于该函数，函数执行完之后，局部变量也就销毁。但是由于 JavaScript 没有块级作用域的概念，即在函数代码块中定义的变量在代码块之外也能访问到，为了解决这种问题，可以使用<strong>匿名函数模仿块级作用域（私有作用域）</strong>来解决。语法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// 块级作用域</span></div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>JavaScript 将 function 关键字当作一个<strong>函数声明</strong>的开始，而<strong>函数声明</strong>后面不能跟圆括号。然而，<strong>函数表达式</strong>的后面可以跟圆括号。要将函数声明转换为函数表达式，只需给它加上一对圆括号。</p>
<p>私有作用域这种技术经常在全局作用域中被用在函数外部，从而限制向全局作用域中添加过多的变量和函数。一般来说，我们都应该尽量少向全局作用域中添加变量和函数。</p>
<p>私有作用域这种做法可以减少闭包占用的内存问题，因为没有指向匿名函数的引用。只要函数执行完毕，就可以立即销毁其作用域链。</p>
<p>引用书中例子，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">outputNumbers</span>(<span class="params">count</span>) </span>&#123;</div><div class="line">	(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</div><div class="line">			alert(i);     </div><div class="line">		&#125;                                  <span class="comment">// 执行完之后 i 销毁</span></div><div class="line">	&#125;)();</div><div class="line">	</div><div class="line">	alert(i);                            <span class="comment">// 报错</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="四、私有变量"><a href="#四、私有变量" class="headerlink" title="四、私有变量"></a>四、私有变量</h2><p>任何在函数中定义的变量，都可以认为是私有变量，因为不能在函数的外部访问这些变量。私有变量一般包括函数的参数、局部变量和在函数内部定义的其它函数。</p>
<p><strong>特权方法：</strong>有权访问私有变量和私有函数的公有方法。</p>
<h3 id="1、创建特权方法的方式"><a href="#1、创建特权方法的方式" class="headerlink" title="1、创建特权方法的方式"></a>1、创建特权方法的方式</h3><p>第一种方法：在<strong>构造函数</strong>中定义特权方法（之所以能够在构造函数中定义特权方法，是因为特权方法作为闭包有权访问在构造函数中定义的所以变量和函数。）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyObject</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	</div><div class="line">	<span class="comment">// 私有变量和私有函数</span></div><div class="line">	<span class="keyword">var</span> privateVariable = <span class="number">10</span>;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">privateFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">// 特权方法</span></div><div class="line">	<span class="keyword">this</span>.publicMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		privateVariable++;</div><div class="line">		<span class="keyword">return</span> privateFunction();</div><div class="line">	&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用该种方法的缺点是构造函数模式针对每个实例都会创建同样一组新方法，而使用静态私有变量来实现特权方法可以避免这个问题。</p>
<p>第二种方法：通过在私有作用域中定义私有变量或函数，也可以创建特权方法。（原型模式）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	</div><div class="line">	<span class="comment">// 私有变量和私有函数</span></div><div class="line">	<span class="keyword">var</span> privateVaribalbe = <span class="number">10</span>;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">privateFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">// 构造函数</span></div><div class="line">	MyObject = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	&#125;;</div><div class="line">	</div><div class="line">	<span class="comment">// 特权方法</span></div><div class="line">	MyObject.prototype.publicMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		privateVariable++;</div><div class="line">		<span class="keyword">return</span> privateFunction();</div><div class="line">	&#125;;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>通过这种方式创建静态私有变量会因为使用原型而增进代码复用，但每个实例都没有自己的私有变量。</p>
<p>该方法与第一种方法的区别在于：私有变量和函数是由实例共享的。</p>
<h3 id="2、模块模式（道格拉斯）"><a href="#2、模块模式（道格拉斯）" class="headerlink" title="2、模块模式（道格拉斯）"></a>2、模块模式（道格拉斯）</h3><p>模块模式：为单例创建私有变量和特权方法。</p>
<p>模块模式使用场景：如果必须创建一个对象并以某些数据对其进行初始化，同时还要公开一些能够访问这些私有数据的方法。</p>
<p>JavaScript 是以对象字面量的方式来创建单例对象的。</p>
<p>模块模式模板：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> singleton = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// 私有变量和私有函数</span></div><div class="line">	<span class="keyword">var</span> privateVariable = <span class="number">10</span>;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">privateFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">// 特权方法</span></div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		publicProperty: <span class="literal">true</span>;</div><div class="line">		</div><div class="line">		publicMethod: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			privateVariable++;</div><div class="line">			<span class="keyword">return</span> privateFunction();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;();</div></pre></td></tr></table></figure>
<p>创建匿名函数并立即调用匿名函数，将对象字面量作为函数返回值，并将其赋值给变量 singleton；由于对象字面量通过特权方法访问匿名函数中私有变量和私有函数，因此变量 singleton 可以其进行访问。以这种方式创建的每个单例都是 Object 的实例。</p>
<h3 id="3、增强的模块模式"><a href="#3、增强的模块模式" class="headerlink" title="3、增强的模块模式"></a>3、增强的模块模式</h3><p>在返回对象之前加入对其增强的代码。这种增强的模块模式适合那些单例必须是<strong>某种类型的实例</strong>，同时还必须添加某些属性和（或）方法对其加以增强的情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> singleton = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// 私有变量和私有函数</span></div><div class="line">	<span class="keyword">var</span> privateVariable = <span class="number">10</span>;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">privateFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="comment">// 创建自定义类型对象</span></div><div class="line">	<span class="keyword">var</span> object = <span class="keyword">new</span> CustomType();</div><div class="line">	</div><div class="line">	</div><div class="line">	object.publicProperty: <span class="literal">true</span>;</div><div class="line">		</div><div class="line">	object.publicMethod: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		privateVariable++;</div><div class="line">		<span class="keyword">return</span> privateFunction();</div><div class="line">	&#125;;</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> object;</div><div class="line">&#125;();</div></pre></td></tr></table></figure>
<p>以上是在学习 《JavaScript 高级程序设计》（第 3 版）这本书第七章的学习笔记，主要把书中讲到的要点记录下来，方便自己查找。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://panzeyong.github.io/2017/07/09/Canvas-用法一-————-绘制图形/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PANJU">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="PANJU's Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/09/Canvas-用法一-————-绘制图形/" itemprop="url">Canvas 用法一：绘制图形</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-09T12:19:11+08:00">
                2017-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/09/Canvas-用法一-————-绘制图形/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/09/Canvas-用法一-————-绘制图形/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/07/09/Canvas-用法一-————-绘制图形/" class="leancloud_visitors" data-flag-title="Canvas 用法一：绘制图形">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、Canvas-简介"><a href="#一、Canvas-简介" class="headerlink" title="一、Canvas 简介"></a>一、Canvas 简介</h2><p>Canvas 翻译过来为<strong>画布</strong>意思。这好比我们在学画画时，首先要有一块画板，然后使用各种彩色笔在画板上绘制各种各样的图形，最终会呈现给我们一幅优美的画。在这里，Canvas 就相当于画板，我们可以使用画笔在 Canvas 绘制各种各样的图形，最终画出我们想要的图形。</p>
<p>Canvas 是 Android 2D 绘制图形的继承，提供丰富的 API 接口，功能非常强大。根据官方文档的介绍，要绘制某些东西需要 4 中基本组件：</p>
<ul>
<li><p>持有像素的位图（Bitmap）；</p>
</li>
<li><p>画布（Canvas）；</p>
</li>
<li><p>绘图元素（Rect）；</p>
</li>
<li><p>画笔（Paint）。</p>
</li>
</ul>
<h2 id="二、Canvas-API-简介"><a href="#二、Canvas-API-简介" class="headerlink" title="二、Canvas API 简介"></a>二、Canvas API 简介</h2><table><tr><th width="20%">操作类型</th><th width="40%">相关 API</th><th width="40%">API 解释</th></tr><tr align="center"><td rowspan="4">绘制颜色</td><td>drawARGB(int a, int r, int g, int b)</td><td>使用 ARGB 填充整块画布</td></tr><tr align="center"><td>drawColor(int color)</td><td>使用颜色填充整块画布</td></tr><tr align="center"><td>drawColor(int color, PorterDuff.Mode mode)</td><td>使用颜色和 PorterDuff.Mode 填充整块画布</td></tr><tr align="center"><td>drawRGB(int r, int g, int b)</td><td>使用 RGB 填充整块画布</td></tr><tr align="center"><td rowspan="3">绘制点</td><td>drawPoint(float x, float y, Paint paint)</td><td>绘制单个点</td></tr><tr align="center"><td>drawPoints(float[] pts, Paint paint)</td><td>绘制一组点</td></tr><tr align="center"><td>drawPoints(float[] pts, int offset, int count, Paint paint)</td><td>绘制一系列点</td></tr><tr align="center"><td rowspan="3">绘制直线</td><td>drawLine(float startX, float startY, float stopX, float stopY, Paint paint)</td><td>使用画笔绘制直线</td></tr><tr align="center"><td>drawLines(float[] pts, Paint paint)</td><td>使用画笔绘制一组直线</td></tr><tr align="center"><td>drawLines(float[] pts, int offset, int count, Paint paint)</td><td>使用画笔绘制一系列直线</td></tr><tr align="center"><td rowspan="3">绘制矩形</td><td>drawRect(float left, float top, float right, float bottom, Paint paint)</td><br><td rowspan="3">使用画笔绘制矩形</td></tr><tr align="center"><td>drawRect(Rect r, Paint paint)</td></tr><tr align="center"><td>    drawRect(RectF rect, Paint paint)</td></tr><tr align="center"><td rowspan="2">绘制圆角矩形</td><td>drawRoundRect(RectF rect, float rx, float ry, Paint paint)</td><td rowspan="2">使用画笔绘制圆角矩形</td></tr><tr align="center"><td>drawRoundRect(float left, float top, float right, float bottom, float rx, float ry, Paint paint)（Android 5.0 及以上才有）</td></tr><tr align="center"><td rowspan="2">绘制椭圆</td><td>drawOval(float left, float top, float right, float bottom, Paint paint)（Android 5.0 及以上才有）</td><td rowspan="2">使用画笔绘制椭圆</td></tr><tr align="center"><td>drawOval(RectF oval, Paint paint)</td></tr><tr align="center"><td>绘制圆</td><td>drawCircle(float cx, float cy, float radius, Paint paint)</td><td>使用画笔绘制圆</td></tr><tr align="center"><td rowspan="2">绘制圆弧</td><td>drawArc(RectF oval, float startAngle, float sweepAngle, boolean useCenter, Paint paint)</td><td rowspan="2">使用画笔绘制圆弧</td></tr><tr align="center"><td>drawArc(float left, float top, float right, float bottom, float startAngle, float sweepAngle, boolean useCenter, Paint paint)（Android 5.0 及以上才有）</td></tr></table>

<blockquote>
<p>以上只是部分 API 介绍，随着自己进一步学习，会继续完善。</p>
</blockquote>
<h2 id="三、Canvas-用法"><a href="#三、Canvas-用法" class="headerlink" title="三、Canvas 用法"></a>三、Canvas 用法</h2><p>以上介绍部分 Canvas API，那么接下来的任务是学习如何使用相关 API。</p>
<h3 id="1、绘制颜色"><a href="#1、绘制颜色" class="headerlink" title="1、绘制颜色"></a>1、绘制颜色</h3><p>Canvas API 提供 4 个方法用于绘制颜色，即用某种颜色填充整块画布。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">canvas.drawARGB(<span class="number">225</span>, <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>);</div><div class="line"></div><div class="line">canvas.drawColor(Color.GREEN);</div><div class="line"></div><div class="line">canvas.drawRGB(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>);</div><div class="line"></div><div class="line">canvas.drawColor(Color.GREEN, PorterDuff.Mode.LIGHTEN);</div></pre></td></tr></table></figure>
<p>需要注意的是绘制颜色第 4 种方法（即第 7 行代码）中第二个参数 PorterDuff.Mode，具体请参考<a href="https://developer.android.com/reference/android/graphics/PorterDuff.Mode.html" target="_blank" rel="external">官网</a>。（ps：这知识点还不是很了解，有时间再研究。）</p>
<p><img src="/images/canvas/canvas_color.png" alt=""></p>
<p>对于以下各种图形的绘制，都需要画笔，那么就先来创建画笔。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomView</span> <span class="title">extend</span> <span class="title">View</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Paint mPaint;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomView</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomView</span><span class="params">(Context context, @Nullable AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line"></div><div class="line">        mPaint = <span class="keyword">new</span> Paint();</div><div class="line">        mPaint.setColor(Color.GREEN);        <span class="comment">// 设置画笔颜色</span></div><div class="line">        mPaint.setStrokeWidth(<span class="number">2</span>);            <span class="comment">// 设置画笔宽度</span></div><div class="line">        mPaint.setStyle(Paint.Style.STROKE); <span class="comment">// 设置画笔风格（描边）</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2、绘制点"><a href="#2、绘制点" class="headerlink" title="2、绘制点"></a>2、绘制点</h3><p>Canvas API 提供 3 个方法用于绘制单个点、一组点以及一系列点。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 由于点形状比较小，不容易看清，所以将画笔宽度设置大点</span></div><div class="line">mPaint.setStrokeWidth(<span class="number">10</span>);</div><div class="line"></div><div class="line"><span class="comment">// 绘制单个点，画笔颜色为 Color.GREEN</span></div><div class="line">canvas.drawPoint(<span class="number">300</span>, <span class="number">300</span>, mPaint);</div><div class="line"></div><div class="line"><span class="comment">//绘制一组点，画笔颜色为 Color.RED</span></div><div class="line"> mPaint.setColor(Color.RED);</div><div class="line"> canvas.drawPoints(<span class="keyword">new</span> <span class="keyword">float</span>[] &#123;<span class="number">400</span>, <span class="number">400</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">500</span>, <span class="number">500</span>&#125;, mPaint);</div></pre></td></tr></table></figure>
<p>有没有发现点的形状是正方形，这是因为 Paint 默认 Paint.Cap 属性是 Paint.Cap.SQUARE。如果要修改该属性，可以调用 Paint 方法 <strong>setStrokeCap(Paint.Cap cap)</strong> 修改。</p>
<p><img src="/images/canvas/canvas_point.png" alt=""></p>
<h3 id="3、绘制直线"><a href="#3、绘制直线" class="headerlink" title="3、绘制直线"></a>3、绘制直线</h3><p>Canvas 提供 3 个方法用于绘制单条直线、一组直线和一系列直线。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">mPaint.setStrokeWidth(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="comment">// 绘制单条直线，画笔颜色为 Color.GREEN</span></div><div class="line">mPaint.setColor(Color.GREEN);</div><div class="line">canvas.drawPoint(<span class="number">300</span>, <span class="number">300</span>, mPaint);</div><div class="line"></div><div class="line"><span class="comment">// 绘制一组直线，画笔颜色为 Color.RED</span></div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">canvas.drawLines(<span class="keyword">new</span> <span class="keyword">float</span>[] &#123;<span class="number">400</span>, <span class="number">400</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">300</span>, <span class="number">500</span>, <span class="number">500</span>, <span class="number">500</span>, <span class="number">500</span>, <span class="number">500</span>, <span class="number">400</span>, <span class="number">400</span>&#125;, mPaint);</div><div class="line"></div><div class="line"><span class="comment">// 绘制一系列直线，画笔颜色为 Color.MAGENTA</span></div><div class="line">mPaint.setColor(Color.MAGENTA);</div><div class="line">canvas.drawLines(<span class="keyword">new</span> <span class="keyword">float</span>[] &#123;<span class="number">400</span>, <span class="number">250</span>, <span class="number">300</span>, <span class="number">350</span>, <span class="number">300</span>, <span class="number">350</span>, <span class="number">500</span>, <span class="number">350</span>, <span class="number">500</span>, <span class="number">350</span>, <span class="number">400</span>, <span class="number">250</span>&#125;, <span class="number">0</span>, <span class="number">12</span>, mPaint);</div></pre></td></tr></table></figure>
<p>看下绘制直线第三种方法，即第 13 行代码，方法原型为：<strong>drawLines(float[] pts, int offset, int count, Paint paint)</strong></p>
<ul>
<li><p>pts：绘制直线所需要的点；</p>
</li>
<li><p>offset：跳过点个数，这些点不参与绘制；</p>
</li>
<li><p>count：实际参与绘制个数；</p>
</li>
<li><p>paint：画笔。</p>
</li>
</ul>
<p>该方法相对比较灵活，可以通过参数 offset、count 设置来决定绘制哪些线段。</p>
<p><img src="/images/canvas/canvas_line.png" alt=""></p>
<h3 id="4、绘制矩形"><a href="#4、绘制矩形" class="headerlink" title="4、绘制矩形"></a>4、绘制矩形</h3><p>Canvas API 提供 3 个方法用于绘制矩形。绘制矩形一般只需要两个点就可以绘制，即左上角和右下角这两个点坐标即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Rect rect = <span class="keyword">new</span> Rect(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span> + <span class="number">500</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span> + <span class="number">500</span>);</div><div class="line"></div><div class="line">RectF rectF = <span class="keyword">new</span> RectF(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span> + <span class="number">200</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span> + <span class="number">200</span>);</div><div class="line"></div><div class="line">mPaint.setColor(Color.GREEN);</div><div class="line">canvas.drawRect(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getWidth() / <span class="number">8</span> * <span class="number">3</span>, mPaint);</div><div class="line"></div><div class="line">mPaint.setColor(Color.MAGENTA);</div><div class="line">canvas.drawRect(rectF, mPaint);</div><div class="line"></div><div class="line">mPaint.setColor(Color.RED);</div><div class="line">canvas.drawRect(rect, mPaint);</div></pre></td></tr></table></figure>
<p><img src="/images/canvas/canvas_rect.png" alt=""></p>
<h3 id="5、绘制圆角矩形"><a href="#5、绘制圆角矩形" class="headerlink" title="5、绘制圆角矩形"></a>5、绘制圆角矩形</h3><p>Canvas API 提供 2 种方法用于绘制圆角矩形，其中有一种方法是 Android 5.0 以上才提供，见以上 API 介绍。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 第一种绘制圆角矩形方法</span></div><div class="line">mPaint.setStrokeWidth(<span class="number">5</span>);</div><div class="line">RectF rect = <span class="keyword">new</span> RectF(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>);</div><div class="line">canvas.drawRoundRect(rect, <span class="number">50</span>, <span class="number">50</span>, mPaint);</div><div class="line"></div><div class="line"><span class="comment">// 第二种绘制圆角矩形方法</span></div><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class="line">	canvas.drawRoundRect(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>, <span class="number">50</span>, <span class="number">50</span>, mPaint);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/images/canvas/canvas_round_rect.png" alt=""></p>
<h3 id="6、绘制椭圆"><a href="#6、绘制椭圆" class="headerlink" title="6、绘制椭圆"></a>6、绘制椭圆</h3><p>Canvas API 提供 2 种方法用于绘制椭圆，其中有一种方法是 Android 5.0 以上才提供，见以上 API 介绍。其实椭圆是被包裹在矩形内，话句话说，是矩形的内切图形。绘制椭圆也很容易，只需传入矩形 RectF 和绘制图形 Paint 就可以。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 第一种绘制椭圆方法</span></div><div class="line">RectF rect = <span class="keyword">new</span> RectF(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>);</div><div class="line"></div><div class="line">canvas.drawLine(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">4</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">4</span>, mPaint);</div><div class="line">canvas.drawLine(getWidth() / <span class="number">2</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">2</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>, mPaint);</div><div class="line">canvas.drawRect(rect, mPaint);</div><div class="line">canvas.drawOval(rect, mPaint);</div><div class="line"></div><div class="line"><span class="comment">// 第二种绘制椭圆方法</span></div><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class="line">	canvas.drawOval(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>, mPaint);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上多绘制出矩形和两条直线，主要是为了方便看清。</p>
<p><img src="/images/canvas/canvas_oval.png" alt=""></p>
<h3 id="7、绘制圆形"><a href="#7、绘制圆形" class="headerlink" title="7、绘制圆形"></a>7、绘制圆形</h3><p>Canvas API 提供 1 种方法用于绘制圆形。绘制圆形只需要知道圆心和半径。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">canvas.drawCircle(getWidth() / <span class="number">2</span>, getHeight() / <span class="number">2</span>, <span class="number">200</span>, mPaint);</div><div class="line">mPaint.setStrokeWidth(<span class="number">5</span>);</div><div class="line">mPaint.setStrokeCap(Paint.Cap.ROUND);</div><div class="line">canvas.drawPoint(getWidth() / <span class="number">2</span>, getHeight() / <span class="number">2</span>, mPaint);</div></pre></td></tr></table></figure>
<p>这里我把圆心也给画出来了，画笔的宽度设置为 5，容易看清。</p>
<p><img src="/images/canvas/canvas_circle.png" alt=""></p>
<h3 id="8、绘制圆弧"><a href="#8、绘制圆弧" class="headerlink" title="8、绘制圆弧"></a>8、绘制圆弧</h3><p>Canvas API 提供 2 种方法用于绘制圆弧，其中有一种方法是 Android 5.0 以上才提供，见以上 API 介绍。有必要来解释下这两种方法各个参数的含义，以<strong>drawArc(RectF oval, float startAngle, float sweepAngle, boolean useCenter, Paint paint)</strong> 为例子：</p>
<ul>
<li><p>oval：矩形；</p>
</li>
<li><p>startAngle：起始角度；</p>
</li>
<li><p>sweepAngle：绘制圆弧的角度，即扫描过的角度；</p>
</li>
<li><p>useCenter：true 或者 false，至于区别通过例子来说明。</p>
</li>
<li><p>paint：画笔。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// userCenter 为 true</span></div><div class="line">RectF rectF = <span class="keyword">new</span> RectF(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>);</div><div class="line">canvas.drawRect(rectF, mPaint);</div><div class="line">mPaint.setStyle(Paint.Style.FILL);</div><div class="line">canvas.drawArc(rectF, <span class="number">0</span>, <span class="number">90</span>, <span class="keyword">true</span>, mPaint);</div><div class="line"></div><div class="line">canvas.translate(getWidth() / <span class="number">16</span>, getHeight() / <span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="comment">// userCenter 为 false    </span></div><div class="line">mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">RectF rect = <span class="keyword">new</span> RectF(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>);</div><div class="line">canvas.drawRect(rect, mPaint);</div><div class="line">mPaint.setStyle(Paint.Style.FILL);</div><div class="line">canvas.drawArc(rect, <span class="number">0</span>, <span class="number">90</span>, <span class="keyword">false</span>, mPaint);</div><div class="line"></div><div class="line"><span class="comment">// 第二种方法</span></div><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class="line">	canvas.drawArc(getWidth() / <span class="number">8</span>, getHeight() / <span class="number">8</span>, getWidth() / <span class="number">8</span> * <span class="number">7</span>, getHeight() / <span class="number">8</span> * <span class="number">3</span>, <span class="number">0</span>, <span class="number">90</span>, <span class="keyword">false</span>, mPaint);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第一个图形是 userCenter 为 true 的效果图；第二个图形则是 userCenter 为 false 的效果图。</p>
<p><img src="/images/canvas/canvas_arc.png" alt=""></p>
<h2 id="四、小示例"><a href="#四、小示例" class="headerlink" title="四、小示例"></a>四、小示例</h2><p>学习了 Canvas 绘制图形的基本用法后，通过一个具体的例子来综合运用绘制图形方法。这个具体的例子是画圆饼，相信大家应该经常看到这种图形。这个例子是参考这篇博客：<a href="http://www.gcssloop.com/customview/Canvas_BasicGraphics" target="_blank" rel="external">安卓自定义View进阶-Canvas之绘制图形</a>，先看看自己实现的效果图吧。</p>
<p><img src="/images/canvas/canvas_round_cake.png" alt=""></p>
<p>简单分析下：画这类图最主要的元素是数据，即总共有多少个模块，每个模块的值具体是多少，每个模块在总数中所占的比例以及用某种颜色表示某个模块。因此，这个可以将其封装为数据类，即 Bean。数据有了之后，接下来就根据我们学过的知识点进行绘制，来看下具体代码吧：</p>
<p>用户数据类 Bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bean</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> color;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> percentage;</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> angle;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> value;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getColor</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> color;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span><span class="params">(<span class="keyword">int</span> color)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.color = color;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPercentage</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> percentage;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPercentage</span><span class="params">(<span class="keyword">float</span> percentage)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.percentage = percentage;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getAngle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> angle;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAngle</span><span class="params">(<span class="keyword">float</span> angle)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.angle = angle;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getValue</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> value;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(<span class="keyword">float</span> value)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.value = value;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>自定义 View 绘制圆饼 RoundCakeView</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoundCakeView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String TAG = RoundCakeView.class.getCanonicalName();</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Paint mPaint;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> List&lt;Bean&gt; mList;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mStartAngle;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mWidth;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mHeight;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RoundCakeView</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RoundCakeView</span><span class="params">(Context context, @Nullable AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RoundCakeView</span><span class="params">(Context context, @Nullable AttributeSet attrs,</span></span></div><div class="line">                         <span class="keyword">int</span> defStyleAttr) &#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        mPaint = <span class="keyword">new</span> Paint(Paint.ANTI_ALIAS_FLAG);</div><div class="line">        mPaint.setStyle(Paint.Style.STROKE);</div><div class="line">        mPaint.setColor(Color.GREEN);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSizeChanged</span><span class="params">(<span class="keyword">int</span> w, <span class="keyword">int</span> h, <span class="keyword">int</span> oldw, <span class="keyword">int</span> oldh)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onSizeChanged(w, h, oldw, oldh);</div><div class="line"></div><div class="line">        <span class="keyword">this</span>.mWidth = w;</div><div class="line">        <span class="keyword">this</span>.mHeight = h;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDraw(canvas);</div><div class="line"></div><div class="line">        Log.d(TAG, <span class="string">"onDraw()"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">int</span> x = mWidth / <span class="number">2</span>;</div><div class="line">        <span class="keyword">int</span> y = mHeight / <span class="number">2</span>;</div><div class="line">        <span class="keyword">int</span> r = <span class="number">200</span>;</div><div class="line"></div><div class="line">        RectF rectF = <span class="keyword">new</span> RectF(x - r, y - r, x + r, y + r);</div><div class="line"></div><div class="line">        <span class="keyword">float</span> currentAngle = mStartAngle;</div><div class="line"></div><div class="line">        <span class="comment">// draw circle point</span></div><div class="line">        mPaint.setStrokeCap(Paint.Cap.ROUND);</div><div class="line">        mPaint.setStrokeWidth(<span class="number">5</span>);</div><div class="line">        canvas.drawPoint(x, y, mPaint);</div><div class="line"></div><div class="line">        <span class="comment">// draw circle</span></div><div class="line">        mPaint.setStrokeWidth(<span class="number">0</span>);</div><div class="line">        mPaint.setColor(Color.RED);</div><div class="line">        canvas.drawCircle(x, y, r, mPaint);</div><div class="line"></div><div class="line">        mPaint.setStyle(Paint.Style.FILL);</div><div class="line"></div><div class="line">        <span class="comment">// draw arc</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mList.size(); i++) &#123;</div><div class="line">            Bean bean = mList.get(i);</div><div class="line">            mPaint.setColor(bean.getColor());</div><div class="line">            canvas.drawArc(rectF, currentAngle, bean.getAngle(), <span class="keyword">true</span>, mPaint);</div><div class="line">            currentAngle += bean.getAngle();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(List&lt;Bean&gt; list)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.mList = list;</div><div class="line">        invalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStartAngle</span><span class="params">(<span class="keyword">float</span> angle)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.mStartAngle = angle;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那么接下来就是显示出效果了，先看下布局文件</p>
<p>activity_main.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span></span></div><div class="line">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></div><div class="line">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">tools:context</span>=<span class="string">"com.pan.canvasdemo.MainActivity"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">com.pan.canvasdemo.RoundCakeView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/rcv"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span></div><div class="line">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>MainActivity.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String TAG = MainActivity.class.getCanonicalName();</div><div class="line"></div><div class="line">    <span class="keyword">private</span> RoundCakeView mView;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> [] mColors = &#123;Color.RED, Color.GREEN, Color.BLUE, Color.DKGRAY, Color.MAGENTA&#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> [] mValues = &#123;<span class="number">23</span>, <span class="number">98</span>, <span class="number">122</span>, <span class="number">78</span>, <span class="number">225</span>&#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> List&lt;Bean&gt; mList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mSum;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        init();</div><div class="line">        initData();</div><div class="line"></div><div class="line">        mView.setStartAngle(<span class="number">0</span>);</div><div class="line">        mView.setList(mList);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        mView = (RoundCakeView) findViewById(R.id.rcv);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initData</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mValues.length; i++) &#123;</div><div class="line">            mSum += mValues[i];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</div><div class="line">            Bean bean = <span class="keyword">new</span> Bean();</div><div class="line">            bean.setColor(mColors[i]);</div><div class="line">            bean.setValue(mValues[i]);</div><div class="line">            bean.setPercentage(bean.getValue() / mSum);</div><div class="line">            bean.setAngle(bean.getPercentage() * <span class="number">360</span>);</div><div class="line">            bean.setName(i + <span class="string">""</span>);</div><div class="line">            mList.add(bean);</div><div class="line"></div><div class="line">            Log.d(TAG, <span class="string">"Value : "</span> + bean.getValue());</div><div class="line">            Log.d(TAG, <span class="string">"Percentage : "</span> + bean.getPercentage());</div><div class="line">            Log.d(TAG, <span class="string">"Angle : "</span> + bean.getAngle());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以下就是画圆饼的具体实现，逻辑不是很难懂，加上部分注释应该很容易理解。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.gcssloop.com/customview/Canvas_BasicGraphics" target="_blank" rel="external">安卓自定义View进阶-Canvas之绘制图形</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="PANJU" />
          <p class="site-author-name" itemprop="name">PANJU</p>
           
              <p class="site-description motion-element" itemprop="description">笔记——记录工作和学习中的点点滴滴</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/PanZeYong" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PANJU</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://panzeyong.disqus.com/count.js" async></script>
    

    

  













  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("b3EUStGjBwcKOJcOMeQXheDT-gzGzoHsz", "xvVsWacpT435FHV1QCcUpx9I");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>
